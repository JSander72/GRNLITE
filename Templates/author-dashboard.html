<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Grn Lite - Author Dashboard</title>
		{% load static %}

		<link rel="stylesheet" href="{% static 'Front_End/CSS/styles.css' %}" />
		<script>
			// JavaScript to dynamically add notifications
			{% comment %} document.addEventListener("DOMContentLoaded", () => {
				function("{{% url 'my_app:notifications' %}}").then((response) => response.json()).then((data) => {
					const notifications = data.notifications;
					const notificationsList = document.getElementById("notifications-list");
					notifications.forEach((notification) => {
						const li = document.createElement("li");
						li.textContent = notification.message;
						notificationsList.appendChild(li);
					});
				}); {% endcomment %}
			document.addEventListener("DOMContentLoaded", function () {
				// Function to fetch and update the Active Titles tile
				function updateActiveTitles() {
					fetch("{% url 'my_app:active-titles' %}")
						.then((response) => response.json())
						.then((data) => {
							// Update the tile with the fetched count
							const activeTitlesElement = document.getElementById(
								"active-titles-count",
							);
							activeTitlesElement.textContent = `${data.draft_count} manuscript(s) in draft status`;
						})
						.catch((error) => {
							console.error("Error fetching Active Titles count:", error);
						});
				}

				// Call the function to update the tile
				updateActiveTitles();
			});
		</script>
	</head>
	<body>
		<div class="dashboard-container">
			<!-- Sidebar -->
			{% include 'author-sidebar.html' %}

			<!-- Main Content -->
			<main class="main-content">
				<div class="content-header">
					<h1>Welcome Back, {{ user.first_name|default:user.username }}!</h1>
					<button class="btn btn-primary">
						<a
							href="{% url 'my_app:manuscript-submission-html' %}"
							style="color: white; text-decoration: none"
							>Add New Title</a
						>
					</button>
				</div>
				<!-- Dashboard Cards -->
				<div class="dashboard-grid">
					<!-- Existing Cards -->
					<div class="card">
						<h3>Active Titles</h3>
						<p id="active-titles-count">Loading...</p>
						<button class="btn btn-secondary">
							<a
								href="{% url 'my_app:feedback-summary-html' %}"
								style="color: white; text-decoration: none"
								>View Books</a
							>
						</button>
					</div>
					<div class="card">
						<h3>Completed Reviews</h3>
						<p>12 reviews received</p>
						<button class="btn btn-secondary">
							<a
								href="{% url 'my_app:author-feedback' %}"
								style="color: white; text-decoration: none"
								>View Feedback</a
							>
						</button>
					</div>
					<div class="card">
						<h3>Find Beta Readers</h3>
						<p>View and hire beta readers for your projects.</p>
						<button class="btn btn-secondary">
							<a
								href="{% url 'my_app:find-beta-readers-html' %}"
								style="color: white; text-decoration: none"
								>Find Beta Readers</a
							>
						</button>
					</div>
					<!-- New Cards -->
					<div class="card">
						<h3>Manuscript Submission</h3>
						<p>Submit and manage your manuscripts here.</p>
						<button class="btn btn-secondary">
							<a
								href="{% url 'my_app:manuscript-submission-html' %}"
								style="color: white; text-decoration: none"
								>Submit Manuscript</a
							>
						</button>
					</div>
				</div>
			</main>
		</div>
		<!-- <script src="{% static 'redirectToAuthPage.js' %}"></script> -->
	</body>
</html>
